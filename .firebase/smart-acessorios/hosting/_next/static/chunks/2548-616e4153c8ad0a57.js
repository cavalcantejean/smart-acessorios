(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2548],{25868:(e,t,r)=>{"use strict";r.d(t,{r:()=>i});var s=r(12115);let a="smartAccessoryFavorites";function o(){let e=localStorage.getItem(a);try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing favorites from localStorage",e),[]}}function i(){let[e,t]=(0,s.useState)([]);(0,s.useEffect)(()=>{t(o())},[]);let r=(0,s.useCallback)(e=>{t(t=>{let r=t.includes(e)?t.filter(t=>t!==e):[...t,e];return localStorage.setItem(a,JSON.stringify(r)),window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:r})),r})},[]);(0,s.useEffect)(()=>{let e=()=>{t(o())},r=e=>{if(e.detail){let r=e.detail;setTimeout(()=>{t(r)},0)}};return window.addEventListener("storage",e),window.addEventListener("favoritesUpdated",r),()=>{window.removeEventListener("storage",e),window.removeEventListener("favoritesUpdated",r)}},[]);let i=(0,s.useCallback)(t=>e.includes(t),[e]);return{favoriteIds:e,toggleFavorite:r,isFavorite:i}}},27820:(e,t,r)=>{"use strict";r.d(t,{default:()=>f});var s=r(95155),a=r(66766),o=r(6874),i=r.n(o),n=r(66695),l=r(30285),c=r(91420),u=r(25868),d=r(66681);function f(e){let{accessory:t,priority:r=!1}=e,{isFavorite:o,toggleFavorite:f}=(0,u.r)(),{isAuthenticated:h,isLoading:m}=(0,d.A)(),g=o(t.id);return(0,s.jsxs)(n.Zp,{className:"flex flex-col overflow-hidden rounded-lg shadow-lg transition-all hover:shadow-xl h-full",children:[(0,s.jsx)(i(),{href:"/accessory/".concat(t.id),className:"block",children:(0,s.jsx)(n.aR,{className:"p-0",children:(0,s.jsx)("div",{className:"aspect-video relative w-full",children:(0,s.jsx)(a.default,{src:t.imageUrl,alt:t.name,fill:!0,style:{objectFit:"cover"},sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",className:"rounded-t-lg","data-ai-hint":t.imageHint||"accessory product",priority:r})})})}),(0,s.jsxs)(n.Wu,{className:"p-4 flex-grow",children:[(0,s.jsx)(i(),{href:"/accessory/".concat(t.id),className:"block",children:(0,s.jsx)(n.ZB,{className:"text-lg font-headline mb-1 hover:text-primary transition-colors",children:t.name})}),(0,s.jsx)(n.BT,{className:"text-sm text-muted-foreground mb-2 line-clamp-2",children:t.shortDescription}),t.price&&(0,s.jsxs)("p",{className:"text-base font-semibold text-primary",children:["R$",t.price.replace(".",",")]})]}),(0,s.jsxs)(n.wL,{className:"p-4 flex justify-between items-center border-t",children:[(0,s.jsx)(l.$,{asChild:!0,variant:"outline",size:"sm",children:(0,s.jsx)(i(),{href:"/accessory/".concat(t.id),children:"Ver Detalhes"})}),!m&&h&&(0,s.jsx)(c.A,{isFavorite:g,onClick:()=>f(t.id)})]})]})}},30285:(e,t,r)=>{"use strict";r.d(t,{$:()=>c,r:()=>l});var s=r(95155),a=r(12115),o=r(99708),i=r(74466),n=r(59434);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:c=!1,...u}=e,d=c?o.DX:"button";return(0,s.jsx)(d,{className:(0,n.cn)(l({variant:a,size:i,className:r})),ref:t,...u})});c.displayName="Button"},35695:(e,t,r)=>{"use strict";var s=r(18999);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},42548:(e,t,r)=>{Promise.resolve().then(r.bind(r,27820))},56104:(e,t,r)=>{"use strict";let s,a,o;r.d(t,{db:()=>a,j:()=>o});var i=r(23915),n=r(35317),l=r(93004);try{console.log("Attempting Firebase initialization..."),0===(0,i.Dk)().length?(s=(0,i.Wp)({apiKey:"AIzaSyCXVzd3bIG1cNsMZ4nPElKkuu_vE9YS-Ys",authDomain:"smart-acessorios.firebaseapp.com",projectId:"smart-acessorios",storageBucket:"smart-acessorios.firebasestorage.app",messagingSenderId:"782394541540",appId:"1:782394541540:web:942c2d58693c497e9573f1",measurementId:"G-ECBEQKZV53"}),console.log("Firebase app initialized successfully in firebase.ts.")):(s=(0,i.Sx)(),console.log("Firebase app already initialized, getting existing app in firebase.ts.")),a=(0,n.aU)(s),o=(0,l.xI)(s),a?console.log("Firestore 'db' instance obtained successfully in firebase.ts."):console.error("!!! Critical Error: Firestore 'db' instance is NULL or UNDEFINED after getFirestore(app) in firebase.ts !!!"),o?console.log("Firebase Auth 'auth' instance obtained successfully in firebase.ts."):console.error("!!! Critical Error: Firebase Auth 'auth' instance is NULL or UNDEFINED after getAuth(app) in firebase.ts !!!")}catch(e){console.error("!!! Firebase/Firestore/Auth Initialization Error in firebase.ts !!!"),e instanceof Error?(console.error("Error Name:",e.name),console.error("Error Message:",e.message),console.error("Error Stack:",e.stack)):console.error("Raw Error Object during Firebase init in firebase.ts:",e)}},59434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var s=r(52596),a=r(39688);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},66681:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,AuthProvider:()=>c});var s=r(12115),a=r(56104),o=r(93004),i=r(35317),n=r(35695);let l=(0,s.createContext)(void 0);function c(e){var t;let{children:r}=e,[c,u]=(0,s.useState)(null),[d,f]=(0,s.useState)(null),[h,m]=(0,s.useState)(!0),g=(0,n.useRouter)(),p=(0,s.useCallback)(async e=>{console.log("useAuth: processAuthStateChange TRIGGERED. fbUser UID:",e?e.uid:"null"),m(!0);try{if(e){console.log("useAuth: fbUser detected. Setting firebaseUser state for UID:",e.uid),f(e),console.log("useAuth: Fetching Firestore data for UID:",e.uid);let t=(0,i.H9)(a.db,"usuarios",e.uid),r=await (0,i.x7)(t);if(r.exists()){let t=r.data(),s={id:e.uid,email:e.email,name:t.name||e.displayName||"Usu\xe1rio",isAdmin:t.isAdmin||!1};console.log("useAuth: Firestore data found & AuthUser set for UID: ".concat(e.uid,", Name: ").concat(s.name,", Admin: ").concat(s.isAdmin)),u(s)}else if(console.warn("useAuth: User ".concat(e.uid," authenticated (Firebase Auth) but NO Firestore document.")),e.providerData.some(e=>e.providerId===o.HF.PROVIDER_ID)){console.log("useAuth: User ".concat(e.uid," is a new social login (e.g., Google). Creating Firestore document."));let r={id:e.uid,name:e.displayName||"Usu\xe1rio Social",email:e.email||"email.social@desconhecido.com",isAdmin:!1,avatarUrl:e.photoURL||"https://placehold.co/150x150.png?text=".concat((e.displayName||"S").charAt(0).toUpperCase()),avatarHint:"user avatar social",bio:"Novo membro via login social!"};await (0,i.BN)(t,{...r,createdAt:(0,i.O5)(),updatedAt:(0,i.O5)()}),console.log("useAuth: Firestore document CREATED for new social user: ".concat(e.uid));let s={id:r.id,email:r.email,name:r.name,isAdmin:r.isAdmin};u(s)}else console.warn("useAuth: User ".concat(e.uid," authenticated via non-social method but NO Firestore document. Forcing logout.")),await (0,o.CI)(a.j)}else console.log("useAuth: No Firebase user (logged out or initial state). Clearing authUser and firebaseUser states."),u(null),f(null)}catch(e){if(console.error("useAuth: CRITICAL ERROR inside processAuthStateChange:",e),u(null),f(null),a.j.currentUser){console.log("useAuth: Attempting to sign out Firebase user due to error in processAuthStateChange.");try{await (0,o.CI)(a.j)}catch(e){console.error("useAuth: Error attempting to sign out Firebase user after error in processAuthStateChange:",e)}}}finally{console.log("useAuth: processAuthStateChange - Bloco FINALLY. Definindo isLoading para FALSE."),m(!1)}},[]);(0,s.useEffect)(()=>{console.log("useAuth: Setting up onAuthStateChanged listener.");let e=(0,o.hg)(a.j,e=>{p(e)});return()=>{console.log("useAuth: Cleaning up onAuthStateChanged listener (AuthProvider unmounted)."),e()}},[p]);let v=(0,s.useCallback)(async()=>{console.log("useAuth: logout function called."),m(!0);try{await (0,o.CI)(a.j),console.log("useAuth: signOut successful. Navigating to homepage."),g.push("/")}catch(e){console.error("useAuth: Error during signOut: ",e),m(!1)}},[g]),b=(0,s.useCallback)(async()=>{console.log("useAuth: refreshAuthUser called.");let e=a.j.currentUser;console.log("useAuth: refreshAuthUser - current Firebase user from auth.currentUser:",e?e.uid:"null"),await p(e)},[p]),A=!h&&!!c&&!!d,x=!h&&null!=(t=null==c?void 0:c.isAdmin)&&t;return s.createElement(l.Provider,{value:{user:c,firebaseUser:d,isAuthenticated:A,isAdmin:x,isLoading:h,logout:v,refreshAuthUser:b}},r)}function u(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},66695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>u,ZB:()=>l,Zp:()=>i,aR:()=>n,wL:()=>d});var s=r(95155),a=r(12115),o=r(59434);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let n=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...a})});n.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});l.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...a})});c.displayName="CardDescription";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...a})});u.displayName="CardContent";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...a})});d.displayName="CardFooter"},68098:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(40157).A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},91420:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(95155),a=r(68098),o=r(30285),i=r(59434);function n(e){let{isFavorite:t,onClick:r,className:n}=e;return(0,s.jsx)(o.$,{variant:"ghost",size:"icon",onClick:e=>{e.preventDefault(),r()},className:(0,i.cn)("rounded-full hover:bg-destructive/10",n),"aria-label":t?"Remover dos favoritos":"Adicionar aos favoritos",children:(0,s.jsx)(a.A,{className:(0,i.cn)("h-5 w-5",t?"fill-destructive text-destructive":"text-muted-foreground")})})}}}]);