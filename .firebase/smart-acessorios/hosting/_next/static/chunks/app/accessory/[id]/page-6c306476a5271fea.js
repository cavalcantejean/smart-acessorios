(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5143],{12543:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(40157).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},21492:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,6874,23)),Promise.resolve().then(s.bind(s,80816))},25868:(e,t,s)=>{"use strict";s.d(t,{r:()=>o});var r=s(12115);let a="smartAccessoryFavorites";function i(){let e=localStorage.getItem(a);try{return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing favorites from localStorage",e),[]}}function o(){let[e,t]=(0,r.useState)([]);(0,r.useEffect)(()=>{t(i())},[]);let s=(0,r.useCallback)(e=>{t(t=>{let s=t.includes(e)?t.filter(t=>t!==e):[...t,e];return localStorage.setItem(a,JSON.stringify(s)),window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:s})),s})},[]);(0,r.useEffect)(()=>{let e=()=>{t(i())},s=e=>{if(e.detail){let s=e.detail;setTimeout(()=>{t(s)},0)}};return window.addEventListener("storage",e),window.addEventListener("favoritesUpdated",s),()=>{window.removeEventListener("storage",e),window.removeEventListener("favoritesUpdated",s)}},[]);let o=(0,r.useCallback)(t=>e.includes(t),[e]);return{favoriteIds:e,toggleFavorite:s,isFavorite:o}}},30285:(e,t,s)=>{"use strict";s.d(t,{$:()=>d,r:()=>l});var r=s(95155),a=s(12115),i=s(99708),o=s(74466),n=s(59434);let l=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:s,variant:a,size:o,asChild:d=!1,...c}=e,u=d?i.DX:"button";return(0,r.jsx)(u,{className:(0,n.cn)(l({variant:a,size:o,className:s})),ref:t,...c})});d.displayName="Button"},59434:(e,t,s)=>{"use strict";s.d(t,{cn:()=>i});var r=s(52596),a=s(39688);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}},61840:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(40157).A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},66080:(e,t,s)=>{"use strict";let r,a,i;s.d(t,{db:()=>i,j:()=>a});var o=s(23915),n=s(93004),l=s(35317),d=s(49509);let c={apiKey:d.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:d.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:"smart-acessorios",storageBucket:d.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:d.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:d.env.NEXT_PUBLIC_FIREBASE_APP_ID};0===(0,o.Dk)().length?(r=(0,o.Wp)(c),console.log("Firebase client app initialized.")):(r=(0,o.Sx)(),console.log("Firebase client app already initialized, getting existing app.")),a=(0,n.xI)(r),i=(0,l.aU)(r)},66681:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,AuthProvider:()=>d});var r=s(12115),a=s(66080),i=s(93004),o=s(35317),n=s(35695);let l=(0,r.createContext)(void 0);function d(e){var t;let{children:s}=e,[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(null),[h,f]=(0,r.useState)(!0),g=(0,n.useRouter)(),p=(0,r.useCallback)(async e=>{console.log("useAuth: processAuthStateChange TRIGGERED. fbUser UID:",e?e.uid:"null"),f(!0);try{if(e){console.log("useAuth: fbUser detected. Setting firebaseUser state for UID:",e.uid),m(e),console.log("useAuth: Fetching Firestore data for UID:",e.uid);let t=(0,o.H9)(a.db,"usuarios",e.uid),s=await (0,o.x7)(t);if(s.exists()){let t=s.data(),r={id:e.uid,email:e.email,name:t.name||e.displayName||"Usu\xe1rio",isAdmin:t.isAdmin||!1};console.log("useAuth: Firestore data found & AuthUser set for UID: ".concat(e.uid,", Name: ").concat(r.name,", Admin: ").concat(r.isAdmin)),c(r)}else if(console.warn("useAuth: User ".concat(e.uid," authenticated (Firebase Auth) but NO Firestore document.")),e.providerData.some(e=>e.providerId===i.HF.PROVIDER_ID)){console.log("useAuth: User ".concat(e.uid," is a new social login (e.g., Google). Creating Firestore document."));let s={id:e.uid,name:e.displayName||"Usu\xe1rio Social",email:e.email||"email.social@desconhecido.com",isAdmin:!1,avatarUrl:e.photoURL||"https://placehold.co/150x150.png?text=".concat((e.displayName||"S").charAt(0).toUpperCase()),avatarHint:"user avatar social",bio:"Novo membro via login social!"};await (0,o.BN)(t,{...s,createdAt:(0,o.O5)(),updatedAt:(0,o.O5)()}),console.log("useAuth: Firestore document CREATED for new social user: ".concat(e.uid));let r={id:s.id,email:s.email,name:s.name,isAdmin:s.isAdmin};c(r)}else console.warn("useAuth: User ".concat(e.uid," authenticated via non-social method but NO Firestore document. Forcing logout.")),await (0,i.CI)(a.j)}else console.log("useAuth: No Firebase user (logged out or initial state). Clearing authUser and firebaseUser states."),c(null),m(null)}catch(e){if(console.error("useAuth: CRITICAL ERROR inside processAuthStateChange:",e),c(null),m(null),a.j.currentUser){console.log("useAuth: Attempting to sign out Firebase user due to error in processAuthStateChange.");try{await (0,i.CI)(a.j)}catch(e){console.error("useAuth: Error attempting to sign out Firebase user after error in processAuthStateChange:",e)}}}finally{console.log("useAuth: processAuthStateChange - Bloco FINALLY. Definindo isLoading para FALSE."),f(!1)}},[]);(0,r.useEffect)(()=>{console.log("useAuth: Setting up onAuthStateChanged listener.");let e=(0,i.hg)(a.j,e=>{p(e)});return()=>{console.log("useAuth: Cleaning up onAuthStateChanged listener (AuthProvider unmounted)."),e()}},[p]);let v=(0,r.useCallback)(async()=>{console.log("useAuth: logout function called."),f(!0);try{await (0,i.CI)(a.j),console.log("useAuth: signOut successful. Navigating to homepage."),g.push("/")}catch(e){console.error("useAuth: Error during signOut: ",e),f(!1)}},[g]),A=(0,r.useCallback)(async()=>{console.log("useAuth: refreshAuthUser called.");let e=a.j.currentUser;console.log("useAuth: refreshAuthUser - current Firebase user from auth.currentUser:",e?e.uid:"null"),await p(e)},[p]),x=!h&&!!d&&!!u,b=!h&&null!=(t=null==d?void 0:d.isAdmin)&&t;return r.createElement(l.Provider,{value:{user:d,firebaseUser:u,isAuthenticated:x,isAdmin:b,isLoading:h,logout:v,refreshAuthUser:A}},s)}function c(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},66695:(e,t,s)=>{"use strict";s.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>o,aR:()=>n,wL:()=>u});var r=s(95155),a=s(12115),i=s(59434);let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});o.displayName="Card";let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...a})});n.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});l.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",s),...a})});c.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s),...a})});u.displayName="CardFooter"},68098:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(40157).A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},80816:(e,t,s)=>{"use strict";s.d(t,{default:()=>v});var r=s(95155),a=s(25868),i=s(12115),o=s(30285),n=s(66695),l=s(66766),d=s(6874),c=s.n(d),u=s(12543),m=s(61840),h=s(91420),f=s(87481),g=s(66681);function p(e){let{accessory:t,isFavoriteInitial:s,onToggleFavorite:a}=e,[d,p]=(0,i.useState)(t),[v,A]=(0,i.useState)(t.aiSummary||t.shortDescription),[x,b]=(0,i.useState)(s),{toast:y}=(0,f.dj)(),{user:N,isAuthenticated:w,isAdmin:E,isLoading:S}=(0,g.A)();return(0,i.useEffect)(()=>{p(t),A(t.aiSummary||t.shortDescription),b(s)},[t,s,w,N]),(0,r.jsxs)(n.Zp,{className:"overflow-hidden shadow-xl",children:[(0,r.jsxs)(n.aR,{className:"p-0 relative",children:[(0,r.jsx)("div",{className:"aspect-video w-full relative",children:(0,r.jsx)(l.default,{src:d.imageUrl,alt:d.name,fill:!0,style:{objectFit:"cover"},sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw","data-ai-hint":d.imageHint||"accessory details",priority:!0})}),!S&&w&&(0,r.jsx)("div",{className:"absolute top-4 right-4 flex gap-2",children:(0,r.jsx)(h.A,{isFavorite:x,onClick:()=>{if(!w)return void y({title:"Login Necess\xe1rio",description:"Voc\xea precisa estar logado para favoritar acess\xf3rios.",variant:"destructive"});a(d.id),b(!x),y({title:x?"Removido dos favoritos.":"Adicionado aos favoritos!",description:d.name})},className:"bg-background/70 hover:bg-background"})}),(0,r.jsx)("div",{className:"absolute top-4 left-4",children:(0,r.jsx)(o.$,{variant:"outline",size:"icon",asChild:!0,className:"bg-background/70 hover:bg-background",children:(0,r.jsxs)(c(),{href:"/",children:[(0,r.jsx)(u.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"sr-only",children:"Voltar \xe0 lista"})]})})})]}),(0,r.jsxs)(n.Wu,{className:"p-6 space-y-4",children:[(0,r.jsx)("div",{className:"flex justify-between items-start",children:(0,r.jsx)(n.ZB,{className:"text-3xl font-headline",children:d.name})}),d.category&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Categoria: ",d.category]}),d.price&&(0,r.jsxs)("p",{className:"text-2xl font-semibold text-primary",children:["R$",d.price.replace(".",",")]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Resumo"}),(0,r.jsx)("p",{className:"text-muted-foreground text-sm leading-relaxed",children:v})]}),d.fullDescription&&(0,r.jsxs)("details",{className:"mt-4",children:[(0,r.jsx)("summary",{className:"cursor-pointer text-sm text-primary hover:underline",children:"Ver Descri\xe7\xe3o Completa"}),(0,r.jsx)("p",{className:"text-muted-foreground text-sm mt-2 leading-relaxed whitespace-pre-line",children:d.fullDescription})]}),d.embedHtml&&(0,r.jsx)("div",{className:"my-6 rounded-lg overflow-hidden shadow-md aspect-video",children:(0,r.jsx)("div",{className:"[&_iframe]:w-full [&_iframe]:h-full [&_iframe]:rounded-lg",dangerouslySetInnerHTML:{__html:d.embedHtml}})})]}),(0,r.jsx)(n.wL,{className:"p-6 bg-secondary/30",children:(0,r.jsx)(o.$,{asChild:!0,className:"w-full bg-accent hover:bg-accent/90 text-accent-foreground",children:(0,r.jsxs)(c(),{href:d.affiliateLink,target:"_blank",rel:"noopener noreferrer",children:["Comprar Agora ",(0,r.jsx)(m.A,{className:"ml-2 h-4 w-4"})]})})})]})}function v(e){let{accessory:t}=e,{isFavorite:s,toggleFavorite:i}=(0,a.r)(),o={...t};return(0,r.jsx)(p,{accessory:o,isFavoriteInitial:s(t.id),onToggleFavorite:i})}},87481:(e,t,s)=>{"use strict";s.d(t,{dj:()=>m});var r=s(12115);let a=0,i=new Map,o=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?o(s):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=n(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,s=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=r.useState(d);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},91420:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(95155),a=s(68098),i=s(30285),o=s(59434);function n(e){let{isFavorite:t,onClick:s,className:n}=e;return(0,r.jsx)(i.$,{variant:"ghost",size:"icon",onClick:e=>{e.preventDefault(),s()},className:(0,o.cn)("rounded-full hover:bg-destructive/10",n),"aria-label":t?"Remover dos favoritos":"Adicionar aos favoritos",children:(0,r.jsx)(a.A,{className:(0,o.cn)("h-5 w-5",t?"fill-destructive text-destructive":"text-muted-foreground")})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,6073,6874,3796,9502,6257,6766,8441,1684,7358],()=>t(21492)),_N_E=e.O()}]);