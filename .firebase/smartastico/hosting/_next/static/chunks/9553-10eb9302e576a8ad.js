(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9553],{19590:(e,r,t)=>{"use strict";t.d(r,{default:()=>U});var o=t(95155),a=t(90221),s=t(62177),n=t(55594);let i=n.z.object({code:n.z.string().min(3,"O c\xf3digo deve ter pelo menos 3 caracteres.").max(50,"O c\xf3digo n\xe3o pode exceder 50 caracteres."),description:n.z.string().min(5,"A descri\xe7\xe3o deve ter pelo menos 5 caracteres.").max(200,"A descri\xe7\xe3o n\xe3o pode exceder 200 caracteres."),discount:n.z.string().min(1,"O valor/tipo do desconto \xe9 obrigat\xf3rio (ex: 20% OFF, R$10, Frete Gr\xe1tis)."),expiryDate:n.z.string().optional().refine(e=>{if(!e)return!0;if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;let r=new Date(e+"T00:00:00");if(isNaN(r.getTime()))return!1;let t=new Date;return t.setHours(0,0,0,0),r>=t},{message:"Data de validade inv\xe1lida ou no passado. Use o formato YYYY-MM-DD ou deixe em branco."}),store:n.z.string().max(100,"O nome da loja n\xe3o pode exceder 100 caracteres.").optional(),applyUrl:n.z.string().url("URL de aplica\xe7\xe3o inv\xe1lida. Use o formato https://...").optional().or(n.z.literal(""))});var d=t(30285),l=t(75937),c=t(62523),u=t(88539),m=t(87481),p=t(50172),f=t(59119),x=t(51920),v=t(86318),g=t(12115),h=t(35695),b=t(20547),y=t(59434);let j=b.bL,w=b.l9,N=g.forwardRef((e,r)=>{let{className:t,align:a="center",sideOffset:s=4,...n}=e;return(0,o.jsx)(b.ZL,{children:(0,o.jsx)(b.UC,{ref:r,align:a,sideOffset:s,className:(0,y.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})});N.displayName=b.UC.displayName;var S=t(47650),R=t(34477);let _=(0,R.createServerReference)("706b11f92e4fb58fddf46c74db71501b51b043ba10",R.callServer,void 0,R.findSourceMapURL,"updateCouponAction"),O=(0,R.createServerReference)("600c69dc0d5c7fdb4e2bec07f4a2bf6df0cfa6bb91",R.callServer,void 0,R.findSourceMapURL,"addCouponAction");var D=t(965),I=t(73158),T=t(43900);function A(e){let{className:r,classNames:t,showOutsideDays:a=!0,...s}=e;return(0,o.jsx)(T.hv,{showOutsideDays:a,className:(0,y.cn)("p-3",r),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,y.cn)((0,d.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,y.cn)((0,d.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{className:r,...t}=e;return(0,o.jsx)(D.A,{className:(0,y.cn)("h-4 w-4",r),...t})},IconRight:e=>{let{className:r,...t}=e;return(0,o.jsx)(I.A,{className:(0,y.cn)("h-4 w-4",r),...t})}},...s})}A.displayName="Calendar";var C=t(83343),M=t(44861),F=t(73168),z=t(90540);function E(e){let{buttonText:r}=e,{pending:t}=(0,S.useFormStatus)();return(0,o.jsxs)(d.$,{type:"submit",className:"w-full sm:w-auto",disabled:t,children:[t?(0,o.jsx)(p.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,o.jsx)(f.A,{className:"mr-2 h-4 w-4"}),r]})}function U(e){let{initialData:r,submitButtonText:t="Salvar Cupom"}=e,{toast:n}=(0,m.dj)(),p=(0,h.useRouter)(),[f,b]=(0,S.useFormState)((null==r?void 0:r.id)?_.bind(null,r.id):O,void 0),R=(null==r?void 0:r.expiryDate)?(0,C.H)(r.expiryDate):null,D=R&&(0,M.f)(R)?(0,F.GP)(R,"yyyy-MM-dd"):"",I=(0,s.mN)({resolver:(0,a.u)(i),defaultValues:{code:(null==r?void 0:r.code)||"",description:(null==r?void 0:r.description)||"",discount:(null==r?void 0:r.discount)||"",expiryDate:D,store:(null==r?void 0:r.store)||"",applyUrl:(null==r?void 0:r.applyUrl)||""}});return(0,g.useEffect)(()=>{if(f){if(f.success)n({title:"Sucesso!",description:f.message}),!f.coupon||(null==r?void 0:r.id)?(null==r?void 0:r.id)&&p.push("/admin/coupons"):I.reset({code:"",description:"",discount:"",expiryDate:"",store:"",applyUrl:""});else if(f.error){let e="Ocorreu um erro.";if("string"==typeof f.error?e=f.error:"object"==typeof f.error&&(e=Object.values(f.error).flat()[0]||"Verifique os campos do formul\xe1rio."),n({title:"Erro ao Salvar",description:e,variant:"destructive"}),"object"==typeof f.error)for(let[e,r]of Object.entries(f.error))r&&r.length>0&&I.setError(e,{type:"server",message:r[0]})}}},[f,I,p,n,null==r?void 0:r.id]),(0,o.jsx)(l.lV,{...I,children:(0,o.jsxs)("form",{action:b,onSubmit:I.handleSubmit(async e=>{let r=new FormData;for(let t in e){let o=e[t];null!=o&&r.append(t,String(o))}await b(r)}),className:"space-y-8",children:[(null==f?void 0:f.error)&&"string"==typeof f.error&&(0,o.jsx)("div",{className:"p-3 text-sm text-destructive bg-red-100 border border-destructive rounded-md",children:f.error}),(0,o.jsx)(l.zB,{control:I.control,name:"code",render:e=>{let{field:r}=e;return(0,o.jsxs)(l.eI,{children:[(0,o.jsx)(l.lR,{children:"C\xf3digo do Cupom"}),(0,o.jsx)(l.MJ,{children:(0,o.jsx)(c.p,{placeholder:"EX: PROMO25",...r})}),(0,o.jsx)(l.C5,{})]})}}),(0,o.jsx)(l.zB,{control:I.control,name:"discount",render:e=>{let{field:r}=e;return(0,o.jsxs)(l.eI,{children:[(0,o.jsx)(l.lR,{children:"Valor/Tipo do Desconto"}),(0,o.jsx)(l.MJ,{children:(0,o.jsx)(c.p,{placeholder:"Ex: 25% OFF, R$10, Frete Gr\xe1tis",...r})}),(0,o.jsx)(l.Rr,{children:"O que o usu\xe1rio ganha ao usar o cupom."}),(0,o.jsx)(l.C5,{})]})}}),(0,o.jsx)(l.zB,{control:I.control,name:"description",render:e=>{let{field:r}=e;return(0,o.jsxs)(l.eI,{children:[(0,o.jsx)(l.lR,{children:"Descri\xe7\xe3o"}),(0,o.jsx)(l.MJ,{children:(0,o.jsx)(u.T,{placeholder:"Descreva as condi\xe7\xf5es ou produtos aplic\xe1veis ao cupom.",...r,rows:3})}),(0,o.jsx)(l.C5,{})]})}}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,o.jsx)(l.zB,{control:I.control,name:"expiryDate",render:e=>{let{field:r}=e;return(0,o.jsxs)(l.eI,{className:"flex flex-col",children:[(0,o.jsx)(l.lR,{children:"Data de Validade (Opcional)"}),(0,o.jsxs)(j,{children:[(0,o.jsx)(w,{asChild:!0,children:(0,o.jsx)(l.MJ,{children:(0,o.jsxs)(d.$,{variant:"outline",className:(0,y.cn)("w-full pl-3 text-left font-normal",!r.value&&"text-muted-foreground"),children:[r.value?(0,F.GP)((0,C.H)(r.value),"PPP",{locale:z.F}):(0,o.jsx)("span",{children:"Escolha uma data"}),(0,o.jsx)(x.A,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,o.jsx)(N,{className:"w-auto p-0",align:"start",children:(0,o.jsx)(A,{mode:"single",selected:r.value?(0,C.H)(r.value):void 0,onSelect:e=>r.onChange(e?(0,F.GP)(e,"yyyy-MM-dd"):""),disabled:e=>{let r=new Date;return r.setHours(0,0,0,0),e<r},initialFocus:!0})})]}),(0,o.jsx)(l.Rr,{children:"Deixe em branco se o cupom n\xe3o expirar."}),(0,o.jsx)(l.C5,{})]})}}),(0,o.jsx)(l.zB,{control:I.control,name:"store",render:e=>{let{field:r}=e;return(0,o.jsxs)(l.eI,{children:[(0,o.jsx)(l.lR,{children:"Loja/Marca (Opcional)"}),(0,o.jsx)(l.MJ,{children:(0,o.jsx)(c.p,{placeholder:"Ex: Loja XYZ, MarcaABC",...r,value:r.value||""})}),(0,o.jsx)(l.Rr,{children:"Onde o cupom pode ser usado."}),(0,o.jsx)(l.C5,{})]})}})]}),(0,o.jsx)(l.zB,{control:I.control,name:"applyUrl",render:e=>{let{field:r}=e;return(0,o.jsxs)(l.eI,{children:[(0,o.jsx)(l.lR,{children:"URL de Aplica\xe7\xe3o (Opcional)"}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)(v.A,{className:"h-5 w-5 text-muted-foreground"}),(0,o.jsx)(l.MJ,{className:"flex-grow",children:(0,o.jsx)(c.p,{type:"url",placeholder:"https://loja.com/carrinho?cupom=CODIGO",...r,value:r.value||""})})]}),(0,o.jsx)(l.Rr,{children:"Link direto para a p\xe1gina onde o cupom pode ser aplicado (ex: p\xe1gina do produto ou carrinho)."}),(0,o.jsx)(l.C5,{})]})}}),(0,o.jsx)(E,{buttonText:t})]})})}},30285:(e,r,t)=>{"use strict";t.d(r,{$:()=>l,r:()=>d});var o=t(95155),a=t(12115),s=t(99708),n=t(74466),i=t(59434);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=a.forwardRef((e,r)=>{let{className:t,variant:a,size:n,asChild:l=!1,...c}=e,u=l?s.DX:"button";return(0,o.jsx)(u,{className:(0,i.cn)(d({variant:a,size:n,className:t})),ref:r,...c})});l.displayName="Button"},49553:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,6874,23)),Promise.resolve().then(t.bind(t,19590))},59434:(e,r,t)=>{"use strict";t.d(r,{cn:()=>s});var o=t(52596),a=t(39688);function s(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.QP)((0,o.$)(r))}},62523:(e,r,t)=>{"use strict";t.d(r,{p:()=>n});var o=t(95155),a=t(12115),s=t(59434);let n=a.forwardRef((e,r)=>{let{className:t,type:a,...n}=e;return(0,o.jsx)("input",{type:a,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n})});n.displayName="Input"},75937:(e,r,t)=>{"use strict";t.d(r,{lV:()=>u,MJ:()=>h,Rr:()=>b,zB:()=>p,eI:()=>v,lR:()=>g,C5:()=>y});var o=t(95155),a=t(12115),s=t(99708),n=t(62177),i=t(59434),d=t(40968);let l=(0,t(74466).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,o.jsx)(d.b,{ref:r,className:(0,i.cn)(l(),t),...a})});c.displayName=d.b.displayName;let u=n.Op,m=a.createContext({}),p=e=>{let{...r}=e;return(0,o.jsx)(m.Provider,{value:{name:r.name},children:(0,o.jsx)(n.xI,{...r})})},f=()=>{let e=a.useContext(m),r=a.useContext(x),{getFieldState:t,formState:o}=(0,n.xW)(),s=t(e.name,o);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=r;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...s}},x=a.createContext({}),v=a.forwardRef((e,r)=>{let{className:t,...s}=e,n=a.useId();return(0,o.jsx)(x.Provider,{value:{id:n},children:(0,o.jsx)("div",{ref:r,className:(0,i.cn)("space-y-2",t),...s})})});v.displayName="FormItem";let g=a.forwardRef((e,r)=>{let{className:t,...a}=e,{error:s,formItemId:n}=f();return(0,o.jsx)(c,{ref:r,className:(0,i.cn)(s&&"text-destructive",t),htmlFor:n,...a})});g.displayName="FormLabel";let h=a.forwardRef((e,r)=>{let{...t}=e,{error:a,formItemId:n,formDescriptionId:i,formMessageId:d}=f();return(0,o.jsx)(s.DX,{ref:r,id:n,"aria-describedby":a?"".concat(i," ").concat(d):"".concat(i),"aria-invalid":!!a,...t})});h.displayName="FormControl";let b=a.forwardRef((e,r)=>{let{className:t,...a}=e,{formDescriptionId:s}=f();return(0,o.jsx)("p",{ref:r,id:s,className:(0,i.cn)("text-sm text-muted-foreground",t),...a})});b.displayName="FormDescription";let y=a.forwardRef((e,r)=>{var t;let{className:a,children:s,...n}=e,{error:d,formMessageId:l}=f(),c=d?String(null!=(t=null==d?void 0:d.message)?t:""):s;return c?(0,o.jsx)("p",{ref:r,id:l,className:(0,i.cn)("text-sm font-medium text-destructive",a),...n,children:c}):null});y.displayName="FormMessage"},87481:(e,r,t)=>{"use strict";t.d(r,{dj:()=>m});var o=t(12115);let a=0,s=new Map,n=e=>{if(s.has(e))return;let r=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,r)},i=(e,r)=>{switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===r.toast.id?{...e,...r.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=r;return t?n(t):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===r.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==r.toastId)}}},d=[],l={toasts:[]};function c(e){l=i(l,e),d.forEach(e=>{e(l)})}function u(e){let{...r}=e,t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),o=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...r,id:t,open:!0,onOpenChange:e=>{e||o()}}}),{id:t,dismiss:o,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function m(){let[e,r]=o.useState(l);return o.useEffect(()=>(d.push(r),()=>{let e=d.indexOf(r);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},88539:(e,r,t)=>{"use strict";t.d(r,{T:()=>n});var o=t(95155),a=t(12115),s=t(59434);let n=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,o.jsx)("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...a})});n.displayName="Textarea"}}]);